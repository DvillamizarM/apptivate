{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\dani1\\\\Desktop\\\\apptivate\\\\src\\\\components\\\\companion\\\\UpdateCompanionInfo.tsx\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect } from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\n\nvar _require = require(\"react-native-expo-viewport-units\"),\n    vmin = _require.vmin;\n\nimport firebase from \"../../../database/firebase\";\nimport * as yup from \"yup\";\nimport Password from \"../Simple/PasswordTextField\";\nimport { connect } from \"react-redux\";\nimport { actionsUser } from \"../../redux/actions/actionsUser\";\nimport ChargeScreen from \"../Simple/ChargeScreen\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\n\nfunction UpdateCompanionInfo(props) {\n  var _useState = useState({\n    email: \"\",\n    password: \"\",\n    name: \"\",\n    id: \"\",\n    genero: \"\",\n    phone: \"\",\n    newPassWord: \"\"\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      data = _useState2[0],\n      setdata = _useState2[1];\n\n  var _useState3 = useState(true),\n      _useState4 = _slicedToArray(_useState3, 2),\n      loading = _useState4[0],\n      setLoading = _useState4[1];\n\n  var schema = yup.object().shape({\n    email: yup.string().required(\"El campo es obligatorio\").email(\"Por favor ingrese un correo válido\"),\n    password: yup.string().required(\"El campo es obligatorio\").max(20, \"No puede contener mas de ${max} letras\").min(6, \"No puede contener menos de ${min} letras\"),\n    name: yup.string().required(\"El campo es obligatorio\").max(30, \"No puede contener mas de ${max} letras\").min(8, \"No puede contener menos de ${min} letras\").matches(/^[^0-9]+$/, \"No puede contener números o símbolos\"),\n    id: yup.string().required(\"El campo es obligatorio\").matches(/^\\d+$/, \"No puede contener letras o símbolos\").max(15, \"No puede contener mas de ${max} letras\").min(8, \"No puede contener menos de ${min} letras\"),\n    phone: yup.string().required(\"El campo es obligatorio\").matches(/^\\d+$/, \"No puede contener letras o símbolos\").max(12, \"No puede contener mas de ${max} letras\").min(7, \"No puede contener menos de {min} letras\")\n  });\n  useEffect(function () {\n    firebase.db.collection(\"users\").doc(props.user.uid).get().then(function (user_db) {\n      setdata(_objectSpread({}, user_db.data().personal));\n      setLoading(false);\n    }).catch(function (e) {\n      console.log(\"El error es \", e);\n    });\n  }, []);\n\n  var reauthenticate = function reauthenticate(currentPassword) {\n    var user = firebase.auth.currentUser;\n    var cred = firebase.firebase.auth.EmailAuthProvider.credential(user.email, currentPassword);\n    return user.reauthenticateWithCredential(cred);\n  };\n\n  var update = function update() {\n    return _regeneratorRuntime.async(function update$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(reauthenticate(data.password).then(function () {\n              var user = firebase.auth.currentUser;\n              user.updateEmail(data.email).then(function () {\n                Alert.alert(\"Correo actualizado\");\n              }).catch(function (error) {\n                console.log(error);\n              });\n            }).catch(function (error) {\n              console.log(error);\n            }));\n\n          case 2:\n            if (!(data.newPassWord !== \"\")) {\n              _context.next = 5;\n              break;\n            }\n\n            _context.next = 5;\n            return _regeneratorRuntime.awrap(reauthenticate(data.password).then(function () {\n              var user = firebase.auth.currentUser;\n              user.updatePassword(data.newPassWord).then(function () {\n                Alert.alert(\"Contraseña Actualizada\");\n              }).catch(function (error) {\n                console.log(error);\n              });\n            }).catch(function (error) {\n              console.log(error);\n            }));\n\n          case 5:\n            _context.next = 7;\n            return _regeneratorRuntime.awrap(firebase.db.collection(\"users\").doc(props.user.uid).update({\n              personal: {\n                name: data.name,\n                phone: data.phone,\n                email: data.email,\n                genero: data.genero,\n                id: data.id\n              }\n            }).then(function (e) {\n              Alert.alert(\"Datos personales del usuario actualizados\");\n              var newUser = firebase.auth.currentUser;\n              newUser[\"information\"][\"personal\"] = {\n                name: data.name,\n                phone: data.phone,\n                email: data.email,\n                id: data.id\n              };\n              props.setUser(newUser);\n              props.props.navigation.navigate(\"Home\");\n            }).catch(function (e) {\n              console.log(\"El error es \", e);\n            }));\n\n          case 7:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  if (loading) {\n    return React.createElement(View, {\n      style: {\n        backgroundColor: \"#ffffff\",\n        justifyContent: \"center\",\n        height: \"100%\",\n        width: \"100%\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 13\n      }\n    }, React.createElement(ChargeScreen, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 110\n      }\n    }));\n  } else {\n    return React.createElement(View, {\n      style: styles.container,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 7\n      }\n    }, React.createElement(View, {\n      style: {\n        width: \"100%\",\n        height: \"8%\",\n        flexDirection: \"row\",\n        justifyContent: \"space-around\",\n        alignItems: \"center\",\n        borderBottomColor: \"rgba(214, 212, 210,1)\",\n        marginTop: \"10%\",\n        borderBottomWidth: 1\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 9\n      }\n    }, React.createElement(View, {\n      style: {\n        width: \"14%\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 11\n      }\n    }, React.createElement(TouchableOpacity, {\n      onPress: function onPress() {\n        props.navigation.navigate(\"Home\");\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 13\n      }\n    }, React.createElement(Text, {\n      style: {\n        fontSize: vmin(7),\n        fontWeight: \"bold\",\n        textAlign: \"center\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 15\n      }\n    }, \"<\"))), React.createElement(Text, {\n      style: {\n        fontWeight: \"bold\",\n        width: \"50%\",\n        alignItems: \"center\",\n        fontSize: vmin(5)\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 11\n      }\n    }, \"Editar Perfil\"), React.createElement(TouchableOpacity, {\n      style: styles.button2,\n      onPress: function _callee() {\n        return _regeneratorRuntime.async(function _callee$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                Alert.alert(\"Cerrar Sesión\", \"¿Está seguro que quiere cerrar sesión? \", [{\n                  text: \"Cancelar\",\n                  onPress: function onPress() {},\n                  style: \"cancel\"\n                }, {\n                  text: \"Cerrar Sesión\",\n                  onPress: function onPress() {\n                    return _regeneratorRuntime.async(function onPress$(_context2) {\n                      while (1) {\n                        switch (_context2.prev = _context2.next) {\n                          case 0:\n                            _context2.next = 2;\n                            return _regeneratorRuntime.awrap(firebase.auth.signOut().then(function () {\n                              AsyncStorage.getAllKeys().then(function (keys) {\n                                return AsyncStorage.multiRemove(keys);\n                              }).then(function () {\n                                return props.navigation.navigate(\"Login\");\n                              });\n                            }));\n\n                          case 2:\n                          case \"end\":\n                            return _context2.stop();\n                        }\n                      }\n                    }, null, null, null, Promise);\n                  }\n                }], {\n                  cancelable: false\n                });\n\n              case 1:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, null, null, null, Promise);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 11\n      }\n    }, React.createElement(Text, {\n      style: {\n        color: \"white\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 13\n      }\n    }, \"Cerrar Sesi\\xF3n\"))), React.createElement(View, {\n      style: {\n        height: \"92%\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 9\n      }\n    }, React.createElement(ScrollView, {\n      style: {\n        marginBottom: \"8%\",\n        paddingTop: 8\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 11\n      }\n    }, React.createElement(View, {\n      style: styles.containerInput,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 13\n      }\n    }, React.createElement(Text, {\n      style: styles.headerInput,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 15\n      }\n    }, \"Nombre Completo\"), React.createElement(TextInput, {\n      style: styles.input,\n      onChangeText: function onChangeText(value) {\n        setdata(_objectSpread(_objectSpread({}, data), {}, {\n          name: value\n        }));\n      },\n      value: data.name,\n      placeholder: \"Ingrese Nombres y Apellidos\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 15\n      }\n    })), React.createElement(View, {\n      style: styles.containerInput,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 13\n      }\n    }, React.createElement(Text, {\n      style: styles.headerInput,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 15\n      }\n    }, \"Documento de Identidad\"), React.createElement(TextInput, {\n      style: styles.input,\n      onChangeText: function onChangeText(value) {\n        setdata(_objectSpread(_objectSpread({}, data), {}, {\n          id: value\n        }));\n      },\n      value: data.id,\n      keyboardType: \"number-pad\",\n      placeholder: \"Tarjeta de Identidad o Cédula\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 15\n      }\n    })), React.createElement(View, {\n      style: styles.containerInput,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 13\n      }\n    }, React.createElement(Text, {\n      style: styles.headerInput,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 15\n      }\n    }, \"Tel\\xE9fono\"), React.createElement(TextInput, {\n      style: styles.input,\n      onChangeText: function onChangeText(value) {\n        setdata(_objectSpread(_objectSpread({}, data), {}, {\n          phone: value\n        }));\n      },\n      value: data.phone,\n      keyboardType: \"phone-pad\",\n      placeholder: \"Número telefónico celular\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 267,\n        columnNumber: 15\n      }\n    })), React.createElement(View, {\n      style: styles.containerInput,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 13\n      }\n    }, React.createElement(Text, {\n      style: styles.headerInput,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 15\n      }\n    }, \"Correo Electr\\xF3nico\"), React.createElement(TextInput, {\n      style: styles.input,\n      onChangeText: function onChangeText(value) {\n        setdata(_objectSpread(_objectSpread({}, data), {}, {\n          email: value\n        }));\n      },\n      value: data.email,\n      keyboardType: \"email-address\",\n      placeholder: \"Dirección de correo electrónico\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 15\n      }\n    })), React.createElement(View, {\n      style: styles.containerInput,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 291,\n        columnNumber: 13\n      }\n    }, React.createElement(Text, {\n      style: styles.headerInput,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 15\n      }\n    }, \"G\\xE9nero\"), React.createElement(TextInput, {\n      onChangeText: function onChangeText(value) {\n        setdata(_objectSpread(_objectSpread({}, data), {}, {\n          genero: value\n        }));\n      },\n      style: styles.input,\n      value: data.genero,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293,\n        columnNumber: 15\n      }\n    })), React.createElement(View, {\n      style: styles.containerInput,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 302,\n        columnNumber: 13\n      }\n    }, React.createElement(Text, {\n      style: styles.headerInput,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 303,\n        columnNumber: 15\n      }\n    }, \"Antigua Contrase\\xF1a\"), React.createElement(Password, {\n      label: \"Mínimo 8 caracteres\",\n      onChange: function onChange(value) {\n        setdata(_objectSpread(_objectSpread({}, data), {}, {\n          password: value\n        }));\n      },\n      height: 40,\n      width: \"100%\",\n      value: data.password,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 304,\n        columnNumber: 15\n      }\n    })), React.createElement(View, {\n      style: styles.containerInput,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 315,\n        columnNumber: 13\n      }\n    }, React.createElement(Text, {\n      style: styles.headerInput,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 15\n      }\n    }, \" Nueva Contrase\\xF1a\"), React.createElement(Password, {\n      label: \"Mínimo 8 caracteres\",\n      onChange: function onChange(value) {\n        setdata(_objectSpread(_objectSpread({}, data), {}, {\n          newPassWord: value\n        }));\n      },\n      height: 40,\n      width: \"100%\",\n      value: data.newPassWord,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 317,\n        columnNumber: 15\n      }\n    })), React.createElement(View, {\n      style: {\n        height: \"40%\",\n        width: \"100%\",\n        marginBottom: \"15%\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 327,\n        columnNumber: 13\n      }\n    }, React.createElement(TouchableOpacity, {\n      style: styles.button,\n      onPress: function onPress() {\n        schema.validate(data).then(function () {\n          update();\n        }).catch(function (err) {\n          console.log(err.message);\n        });\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 328,\n        columnNumber: 15\n      }\n    }, React.createElement(Text, {\n      style: {\n        color: \"white\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 341,\n        columnNumber: 17\n      }\n    }, \"Actualizar datos Personales\"))))));\n  }\n}\n\nvar MapStateToProps = function MapStateToProps(store) {\n  return {\n    user: store.User.user\n  };\n};\n\nvar MapDispatchToProps = function MapDispatchToProps(dispatch, store) {\n  return {\n    setUser: function setUser(val) {\n      return dispatch(actionsUser.SET_USER(val));\n    }\n  };\n};\n\nexport default connect(MapStateToProps, MapDispatchToProps)(UpdateCompanionInfo);\nvar styles = StyleSheet.create({\n  header: {\n    height: \"10%\",\n    width: \"90%\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    marginLeft: \"5%\",\n    marginRight: \"5%\"\n  },\n  textHeader: {\n    fontSize: vmin(5)\n  },\n  container: {\n    backgroundColor: \"white\",\n    width: \"100%\",\n    height: \"100%\"\n  },\n  containerInput: {\n    height: vmin(25),\n    width: \"90%\",\n    marginLeft: \"5%\",\n    marginRight: \"5%\",\n    marginBottom: \"2%\",\n    justifyContent: \"space-evenly\"\n  },\n  button: {\n    backgroundColor: \"#6979F8\",\n    width: \"90%\",\n    height: \"14%\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    borderRadius: 10,\n    marginLeft: \"5%\",\n    marginRight: \"5%\"\n  },\n  button2: {\n    backgroundColor: \"rgba(199, 0, 57,1)\",\n    width: \"30%\",\n    height: \"70%\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    borderRadius: 10,\n    shadowColor: \"#000\",\n    shadowOffset: {\n      width: 0,\n      height: 3\n    },\n    shadowOpacity: 0.29,\n    shadowRadius: 4.65,\n    elevation: 7\n  },\n  headerInput: {\n    width: \"100%\",\n    textAlign: \"left\",\n    fontSize: vmin(4),\n    fontWeight: \"bold\",\n    left: vmin(1.5)\n  },\n  input: {\n    height: \"60%\",\n    width: \"100%\",\n    borderColor: \"rgba(228, 228, 228, 0.6)\",\n    borderWidth: 1,\n    borderRadius: 5\n  },\n  scroll: {\n    height: \"90%\",\n    width: \"100%\"\n  }\n});\nvar navigationButtonStyles = StyleSheet.create({\n  containerNavigationButton: {\n    width: \"100%\",\n    flexDirection: \"row\",\n    height: \"80%\",\n    borderRadius: 10,\n    backgroundColor: \"rgba(105, 121, 248, 1)\",\n    justifyContent: \"center\",\n    alignItems: \"center\"\n  },\n  sideButton: {\n    height: \"100%\",\n    width: \"15%\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    borderRadius: 10\n  },\n  navigationButtonText: {\n    height: \"70%\",\n    width: \"70%\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    borderColor: \"rgba(255, 255, 255, 0.3)\",\n    borderLeftWidth: vmin(0.5),\n    borderRightWidth: vmin(0.5)\n  },\n  whiteText: {\n    color: \"white\"\n  }\n});","map":{"version":3,"sources":["C:/Users/dani1/Desktop/apptivate/src/components/companion/UpdateCompanionInfo.tsx"],"names":["React","useState","useEffect","require","vmin","firebase","yup","Password","connect","actionsUser","ChargeScreen","AsyncStorage","UpdateCompanionInfo","props","email","password","name","id","genero","phone","newPassWord","data","setdata","loading","setLoading","schema","object","shape","string","required","max","min","matches","db","collection","doc","user","uid","get","then","user_db","personal","catch","e","console","log","reauthenticate","currentPassword","auth","currentUser","cred","EmailAuthProvider","credential","reauthenticateWithCredential","update","updateEmail","Alert","alert","error","updatePassword","newUser","setUser","navigation","navigate","backgroundColor","justifyContent","height","width","styles","container","flexDirection","alignItems","borderBottomColor","marginTop","borderBottomWidth","fontSize","fontWeight","textAlign","button2","text","onPress","style","signOut","getAllKeys","keys","multiRemove","cancelable","color","marginBottom","paddingTop","containerInput","headerInput","input","value","button","validate","err","message","MapStateToProps","store","User","MapDispatchToProps","dispatch","val","SET_USER","StyleSheet","create","header","marginLeft","marginRight","textHeader","borderRadius","shadowColor","shadowOffset","shadowOpacity","shadowRadius","elevation","left","borderColor","borderWidth","scroll","navigationButtonStyles","containerNavigationButton","sideButton","navigationButtonText","borderLeftWidth","borderRightWidth","whiteText"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\n\r\nimport {\r\n  View,\r\n  Text,\r\n  StyleSheet,\r\n  ScrollView,\r\n  TouchableOpacity,\r\n  TextInput,\r\n  ActivityIndicator,\r\n  Alert,\r\n} from \"react-native\";\r\nvar { vmin } = require(\"react-native-expo-viewport-units\");\r\nimport firebase from \"../../../database/firebase\";\r\nimport * as yup from \"yup\";\r\nimport Password from \"../Simple/PasswordTextField\";\r\n\r\n// redux\r\n\r\nimport { Dispatch } from \"redux\";\r\nimport { connect } from \"react-redux\";\r\nimport * as MyTypes from \"../../redux/types/types\";\r\nimport { actionsUser } from \"../../redux/actions/actionsUser\";\r\nimport ChargeScreen from \"../Simple/ChargeScreen\";\r\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\r\n\r\nfunction UpdateCompanionInfo(props) {\r\n  const [data, setdata] = useState({\r\n    email: \"\",\r\n    password: \"\",\r\n    name: \"\",\r\n    id: \"\",\r\n    genero: \"\",\r\n    phone: \"\",\r\n    newPassWord: \"\",\r\n  });\r\n\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const schema = yup.object().shape({\r\n    email: yup\r\n      .string()\r\n      .required(\"El campo es obligatorio\")\r\n      .email(\"Por favor ingrese un correo válido\"),\r\n    password: yup\r\n      .string()\r\n      .required(\"El campo es obligatorio\")\r\n      .max(20, \"No puede contener mas de ${max} letras\")\r\n      .min(6, \"No puede contener menos de ${min} letras\"),\r\n    name: yup\r\n      .string()\r\n      .required(\"El campo es obligatorio\")\r\n      .max(30, \"No puede contener mas de ${max} letras\")\r\n      .min(8, \"No puede contener menos de ${min} letras\")\r\n      .matches(/^[^0-9]+$/, \"No puede contener números o símbolos\"),\r\n    id: yup\r\n      .string()\r\n      .required(\"El campo es obligatorio\")\r\n      .matches(/^\\d+$/, \"No puede contener letras o símbolos\")\r\n      .max(15, \"No puede contener mas de ${max} letras\")\r\n      .min(8, \"No puede contener menos de ${min} letras\"),\r\n    phone: yup\r\n      .string()\r\n      .required(\"El campo es obligatorio\")\r\n      .matches(/^\\d+$/, \"No puede contener letras o símbolos\")\r\n      .max(12, \"No puede contener mas de ${max} letras\")\r\n      .min(7, \"No puede contener menos de {min} letras\"),\r\n  });\r\n\r\n  useEffect(() => {\r\n    firebase.db\r\n      .collection(\"users\")\r\n      .doc(props.user.uid)\r\n      .get()\r\n      .then((user_db: any) => {\r\n        setdata({ ...user_db.data().personal });\r\n        setLoading(false);\r\n        // props.navigation.navigate(\"Home\");\r\n      })\r\n      .catch((e) => {\r\n        console.log(\"El error es \", e);\r\n      });\r\n  }, []);\r\n\r\n  const reauthenticate = (currentPassword) => {\r\n    var user: any = firebase.auth.currentUser;\r\n    var cred = firebase.firebase.auth.EmailAuthProvider.credential(\r\n      user.email,\r\n      currentPassword\r\n    );\r\n    return user.reauthenticateWithCredential(cred);\r\n  };\r\n\r\n  const update = async () => {\r\n    // primero se actualiza el correo\r\n    await reauthenticate(data.password)\r\n      .then(() => {\r\n        var user: any = firebase.auth.currentUser;\r\n        user\r\n          .updateEmail(data.email)\r\n          .then(() => {\r\n            Alert.alert(\"Correo actualizado\");\r\n          })\r\n          .catch((error) => {\r\n            console.log(error);\r\n          });\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n\r\n    // Luego se actualiza la contraseña\r\n    if (data.newPassWord !== \"\") {\r\n      await reauthenticate(data.password)\r\n        .then(() => {\r\n          var user: any = firebase.auth.currentUser;\r\n          user\r\n            .updatePassword(data.newPassWord)\r\n            .then(() => {\r\n              Alert.alert(\"Contraseña Actualizada\");\r\n            })\r\n            .catch((error) => {\r\n              console.log(error);\r\n            });\r\n        })\r\n        .catch((error) => {\r\n          console.log(error);\r\n        });\r\n    }\r\n\r\n    await firebase.db\r\n      .collection(\"users\")\r\n      .doc(props.user.uid)\r\n      .update({\r\n        personal: {\r\n          name: data.name,\r\n          phone: data.phone,\r\n          email: data.email,\r\n          genero: data.genero,\r\n          id: data.id,\r\n        },\r\n      })\r\n      .then((e) => {\r\n        Alert.alert(\"Datos personales del usuario actualizados\");\r\n\r\n        let newUser: any = firebase.auth.currentUser;\r\n        newUser[\"information\"][\"personal\"] = {\r\n          name: data.name,\r\n          phone: data.phone,\r\n          email: data.email,\r\n          id: data.id,\r\n        };\r\n        props.setUser(newUser);\r\n        props.props.navigation.navigate(\"Home\");\r\n      })\r\n      .catch((e) => {\r\n        console.log(\"El error es \", e);\r\n      });\r\n  };\r\n\r\n  if (loading) {\r\n    return (<View style={{backgroundColor: \"#ffffff\", justifyContent:\"center\",height:\"100%\", width:\"100%\" }}><ChargeScreen/></View>);\r\n  } else {\r\n    return (\r\n      <View style={styles.container}>\r\n        <View\r\n          style={{\r\n            width: \"100%\",\r\n            height: \"8%\",\r\n            flexDirection: \"row\",\r\n            justifyContent: \"space-around\",\r\n            alignItems: \"center\",\r\n            borderBottomColor: \"rgba(214, 212, 210,1)\",\r\n            marginTop: \"10%\",\r\n            borderBottomWidth: 1,\r\n          }}\r\n        >\r\n          <View style={{ width: \"14%\" }}>\r\n            <TouchableOpacity\r\n              onPress={() => {\r\n                props.navigation.navigate(\"Home\");\r\n              }}\r\n            >\r\n              <Text\r\n                style={{\r\n                  fontSize: vmin(7),\r\n                  fontWeight: \"bold\",\r\n                  textAlign: \"center\",\r\n                }}\r\n              >\r\n                {\"<\"}\r\n              </Text>\r\n            </TouchableOpacity>\r\n          </View>\r\n          <Text\r\n            style={{\r\n              fontWeight: \"bold\",\r\n              width: \"50%\",\r\n              alignItems: \"center\",\r\n              fontSize: vmin(5),\r\n            }}\r\n          >\r\n            Editar Perfil\r\n          </Text>\r\n          <TouchableOpacity\r\n            style={styles.button2}\r\n            onPress={async () => {\r\n              //  props.navigation.navigate(\"Login\");\r\n              // await firebase.auth.signOut();\r\n              Alert.alert(\r\n                \"Cerrar Sesión\",\r\n                \"¿Está seguro que quiere cerrar sesión? \",\r\n                [\r\n                  {\r\n                    text: \"Cancelar\",\r\n                    onPress: () => {},\r\n                    style: \"cancel\",\r\n                  },\r\n                  {\r\n                    text: \"Cerrar Sesión\",\r\n                    onPress: async () => {\r\n                      await firebase.auth.signOut().then(() => {\r\n                        AsyncStorage.getAllKeys()\r\n                          .then((keys) => AsyncStorage.multiRemove(keys))\r\n                          .then(() => props.navigation.navigate(\"Login\"));\r\n                      });\r\n                    },\r\n                  },\r\n                ],\r\n                { cancelable: false }\r\n              );\r\n            }}\r\n          >\r\n            <Text style={{ color: \"white\" }}>Cerrar Sesión</Text>\r\n          </TouchableOpacity>\r\n        </View>\r\n\r\n        <View style={{ height: \"92%\" }}>\r\n          <ScrollView style={{ marginBottom: \"8%\", paddingTop:8 }}>\r\n            <View style={styles.containerInput}>\r\n              <Text style={styles.headerInput}>Nombre Completo</Text>\r\n              <TextInput\r\n                style={styles.input}\r\n                onChangeText={(value) => {\r\n                  setdata({ ...data, name: value });\r\n                }}\r\n                value={data.name}\r\n                placeholder={\"Ingrese Nombres y Apellidos\"}\r\n              />\r\n            </View>\r\n\r\n            <View style={styles.containerInput}>\r\n              <Text style={styles.headerInput}>Documento de Identidad</Text>\r\n              <TextInput\r\n                style={styles.input}\r\n                onChangeText={(value) => {\r\n                  setdata({ ...data, id: value });\r\n                }}\r\n                value={data.id}\r\n                keyboardType={\"number-pad\"}\r\n                placeholder={\"Tarjeta de Identidad o Cédula\"}\r\n              />\r\n            </View>\r\n\r\n            <View style={styles.containerInput}>\r\n              <Text style={styles.headerInput}>Teléfono</Text>\r\n              <TextInput\r\n                style={styles.input}\r\n                onChangeText={(value) => {\r\n                  setdata({ ...data, phone: value });\r\n                }}\r\n                value={data.phone}\r\n                keyboardType={\"phone-pad\"}\r\n                placeholder={\"Número telefónico celular\"}\r\n              />\r\n            </View>\r\n\r\n            <View style={styles.containerInput}>\r\n              <Text style={styles.headerInput}>Correo Electrónico</Text>\r\n              <TextInput\r\n                style={styles.input}\r\n                onChangeText={(value) => {\r\n                  setdata({ ...data, email: value });\r\n                }}\r\n                value={data.email}\r\n                keyboardType={\"email-address\"}\r\n                placeholder={\"Dirección de correo electrónico\"}\r\n              />\r\n            </View>\r\n\r\n            <View style={styles.containerInput}>\r\n              <Text style={styles.headerInput}>Género</Text>\r\n              <TextInput\r\n                onChangeText={(value) => {\r\n                  setdata({ ...data, genero: value });\r\n                }}\r\n                style={styles.input}\r\n                value={data.genero}\r\n              />\r\n            </View>\r\n\r\n            <View style={styles.containerInput}>\r\n              <Text style={styles.headerInput}>Antigua Contraseña</Text>\r\n              <Password\r\n                label={\"Mínimo 8 caracteres\"}\r\n                onChange={(value) => {\r\n                  setdata({ ...data, password: value });\r\n                }}\r\n                height={40}\r\n                width={\"100%\"}\r\n                value={data.password}\r\n              />\r\n            </View>\r\n\r\n            <View style={styles.containerInput}>\r\n              <Text style={styles.headerInput}> Nueva Contraseña</Text>\r\n              <Password\r\n                label={\"Mínimo 8 caracteres\"}\r\n                onChange={(value) => {\r\n                  setdata({ ...data, newPassWord: value });\r\n                }}\r\n                height={40}\r\n                width={\"100%\"}\r\n                value={data.newPassWord}\r\n              />\r\n            </View>\r\n            <View style={{height: \"40%\", width:\"100%\", marginBottom:\"15%\"}}>\r\n              <TouchableOpacity\r\n                style={styles.button}\r\n                onPress={() => {\r\n                  schema\r\n                    .validate(data)\r\n                    .then(() => {\r\n                      update();\r\n                    })\r\n                    .catch(function (err) {\r\n                      console.log(err.message);\r\n                    });\r\n                }}\r\n              >\r\n                <Text style={{ color: \"white\" }}>\r\n                  Actualizar datos Personales\r\n                </Text>\r\n              </TouchableOpacity>\r\n            </View>\r\n          </ScrollView>\r\n        </View>\r\n      </View>\r\n    );\r\n  }\r\n}\r\n\r\nconst MapStateToProps = (store: MyTypes.ReducerState) => {\r\n  return {\r\n    user: store.User.user,\r\n  };\r\n};\r\n\r\nconst MapDispatchToProps = (dispatch: Dispatch, store: any) => ({\r\n  setUser: (val) => dispatch(actionsUser.SET_USER(val)),\r\n});\r\nexport default connect(MapStateToProps, MapDispatchToProps)(UpdateCompanionInfo);\r\n\r\nconst styles = StyleSheet.create({\r\n  header: {\r\n    height: \"10%\",\r\n    width: \"90%\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    marginLeft: \"5%\",\r\n    marginRight: \"5%\",\r\n  },\r\n  textHeader: {\r\n    fontSize: vmin(5),\r\n  },\r\n\r\n  container: { backgroundColor: \"white\", width: \"100%\", height: \"100%\" },\r\n\r\n  containerInput: {\r\n    height: vmin(25),\r\n    width: \"90%\",\r\n    // backgroundColor: \"tomato\",\r\n    marginLeft: \"5%\",\r\n    marginRight: \"5%\",\r\n    marginBottom: \"2%\",\r\n    justifyContent: \"space-evenly\",\r\n  },\r\n\r\n  button: {\r\n    backgroundColor: \"#6979F8\",\r\n    width: \"90%\",\r\n    height: \"14%\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    borderRadius: 10,\r\n    marginLeft: \"5%\",\r\n    marginRight: \"5%\",\r\n  },\r\n  button2: {\r\n    backgroundColor: \"rgba(199, 0, 57,1)\",\r\n    width: \"30%\",\r\n    height: \"70%\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    borderRadius: 10,\r\n    shadowColor: \"#000\",\r\n    shadowOffset: {\r\n      width: 0,\r\n      height: 3,\r\n    },\r\n    shadowOpacity: 0.29,\r\n    shadowRadius: 4.65,\r\n\r\n    elevation: 7,\r\n  },\r\n\r\n  headerInput: {\r\n    width: \"100%\",\r\n    textAlign: \"left\",\r\n    fontSize: vmin(4),\r\n    fontWeight: \"bold\",\r\n    left: vmin(1.5),\r\n  },\r\n\r\n  input: {\r\n    height: \"60%\",\r\n    width: \"100%\",\r\n    borderColor: \"rgba(228, 228, 228, 0.6)\",\r\n    borderWidth: 1,\r\n    borderRadius: 5,\r\n  },\r\n\r\n  scroll: {\r\n    height: \"90%\",\r\n    width: \"100%\",\r\n  },\r\n});\r\n\r\nconst navigationButtonStyles = StyleSheet.create({\r\n  containerNavigationButton: {\r\n    width: \"100%\",\r\n    flexDirection: \"row\",\r\n    height: \"80%\",\r\n    borderRadius: 10,\r\n    backgroundColor: \"rgba(105, 121, 248, 1)\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n  },\r\n\r\n  sideButton: {\r\n    height: \"100%\",\r\n    width: \"15%\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    borderRadius: 10,\r\n  },\r\n\r\n  navigationButtonText: {\r\n    height: \"70%\",\r\n    width: \"70%\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    borderColor: \"rgba(255, 255, 255, 0.3)\",\r\n    borderLeftWidth: vmin(0.5),\r\n    borderRightWidth: vmin(0.5),\r\n  },\r\n\r\n  whiteText: {\r\n    color: \"white\",\r\n  },\r\n});\r\n"]},"metadata":{},"sourceType":"module"}